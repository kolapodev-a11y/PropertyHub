<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sell a House â€” PropertyHub</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

<nav class="navbar">
  <div class="nav-inner">
    <a href="index.html" class="nav-logo">
      <svg viewBox="0 0 40 40" fill="none"><rect width="40" height="40" rx="10" fill="#006AFF"/><path d="M20 8L8 18V32H16V24H24V32H32V18L20 8Z" fill="white"/></svg>
      Property<span>Hub</span>
    </a>
    <button class="mobile-menu-toggle" id="mobile-menu-toggle"><span></span><span></span><span></span></button>
    <ul class="nav-menu" id="nav-menu">
      <li><a href="buy-phone.html">ğŸ“± Buy Phone</a></li>
      <li><a href="sell-land.html">ğŸŒ Sell Land</a></li>
      <li><a href="rent-house.html">ğŸ  Rent House</a></li>
      <li><a href="sell-house.html" class="active">ğŸ¡ Sell House</a></li>
    </ul>
    <div class="nav-auth">
      <a href="login.html"    class="btn-outline" id="nav-login">Login</a>
      <a href="register.html" class="btn-primary"  id="nav-register">Sign Up</a>
      <div class="user-menu" id="nav-user-menu" style="display:none;">
        <div class="user-avatar-wrap"><img id="nav-avatar" src="" alt="avatar" /></div>
        <span id="nav-username" class="user-name"></span>
        <button id="nav-logout">Logout</button>
      </div>
    </div>
  </div>
</nav>

<div class="page-banner" style="background: linear-gradient(135deg,#7C2D12 0%,#C2410C 50%,#EA580C 100%);">
  <h1>ğŸ¡ Houses for Sale</h1>
  <p>Find your dream home or sell your property fast</p>
</div>

<div class="page-controls">
  <div class="page-search-wrap">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
    <input type="text" id="page-search" placeholder="Search houses by location, price, featuresâ€¦" />
  </div>
  <div style="display:flex; align-items:center; gap:10px;">
    <span class="results-count" id="results-count"></span>
    <button class="post-listing-btn" id="post-btn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      Sell Your House
    </button>
  </div>
</div>

<div class="section" style="padding-top:0;">
  <div class="listings-grid" id="listings-grid">
    <div class="loading-spinner"><div class="spinner"></div><p>Loading housesâ€¦</p></div>
  </div>
</div>

<footer>
  <div class="footer-inner">
    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;">
      <a href="index.html" class="nav-logo" style="color:white;">
        <svg viewBox="0 0 40 40" fill="none" style="width:28px;height:28px;"><rect width="40" height="40" rx="10" fill="#006AFF"/><path d="M20 8L8 18V32H16V24H24V32H32V18L20 8Z" fill="white"/></svg>
        Property<span style="color:#FFD166">Hub</span>
      </a>
      <div style="display:flex; gap:20px; font-size:.85rem;">
        <a href="buy-phone.html" style="color:rgba(255,255,255,.7)">Buy Phone</a>
        <a href="sell-land.html" style="color:rgba(255,255,255,.7)">Sell Land</a>
        <a href="rent-house.html" style="color:rgba(255,255,255,.7)">Rent House</a>
        <a href="sell-house.html" style="color:rgba(255,255,255,.7)">Sell House</a>
      </div>
    </div>
    <div class="footer-bottom" style="margin-top:24px;"><span>Â© 2025 PropertyHub.</span></div>
  </div>
</footer>

<script type="module">
  import { setupNavAuth } from "./js/auth.js";
  import { getListingsRealtime, renderCard } from "./js/listings.js";

  setupNavAuth();
  const toggle = document.getElementById("mobile-menu-toggle");
  const navMenu = document.getElementById("nav-menu");
  if (toggle) toggle.addEventListener("click", () => navMenu.classList.toggle("open"));

  document.getElementById("post-btn").addEventListener("click", () => {
    window.location.href = "upload.html?cat=sell_house";
  });

  const grid  = document.getElementById("listings-grid");
  const count = document.getElementById("results-count");
  let allListings = [];

  getListingsRealtime("sell_house", (listings) => {
    allListings = listings;
    renderListings(listings);
    count.textContent = listings.length > 0 ? `${listings.length} listing${listings.length !== 1 ? "s" : ""}` : "";
  });

  function renderListings(items) {
    if (items.length === 0) {
      grid.innerHTML = `
        <div class="empty-state">
          <span class="empty-icon">ğŸ¡</span>
          <h3>No houses listed yet</h3>
          <p>Be the first to list your house for sale!</p>
          <button onclick="window.location.href='upload.html?cat=sell_house'" class="btn-primary" style="margin-top:14px;">Sell Your House</button>
        </div>`;
      return;
    }
    grid.innerHTML = items.map(renderCard).join("");
  }

  document.getElementById("page-search").addEventListener("input", (e) => {
    const q = e.target.value.toLowerCase();
    const filtered = q
      ? allListings.filter(l =>
          (l.title||"").toLowerCase().includes(q) ||
          (l.description||"").toLowerCase().includes(q) ||
          (l.locationName||"").toLowerCase().includes(q))
      : allListings;
    count.textContent = `${filtered.length} listing${filtered.length !== 1 ? "s" : ""}`;
    renderListings(filtered);
  });
</script>
</body>
</html>
